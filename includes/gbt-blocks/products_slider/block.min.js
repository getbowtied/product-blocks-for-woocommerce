"use strict";!function(blocks,components,blockEditor,i18n,element){var el=element.createElement,registerBlockType=blocks.registerBlockType,TextControl=components.TextControl,SVG=(components.Button,components.SVG),Path=components.Path,InspectorControls=wp.blockEditor.InspectorControls,apiFetch=wp.apiFetch,useEffect=wp.element.useEffect;registerBlockType("getbowtied/products-slider",{title:i18n.__("Product Slider"),icon:el(SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},el(Path,{d:"M21 18H2v2h19v-2zm-2-8v4H4v-4h15m1-2H3c-.55 0-1 .45-1 1v6c0 .55.45 1 1 1h17c.55 0 1-.45 1-1V9c0-.55-.45-1-1-1zm1-4H2v2h19V4z"})),category:"product_blocks",description:i18n.__("Display products from your store in a full width vertical slider."),keywords:[i18n.__("products"),i18n.__("carousel"),i18n.__("slider")],supports:{align:["full"]},attributes:{productIDs:{type:"string",default:""},queryProducts:{type:"string",default:""},queryProductsLast:{type:"string",default:""},queryDisplayType:{type:"string",default:"default"},isLoading:{type:"boolean",default:!1},selectedIDS:{type:"string",default:""},querySearchSelected:{type:"array",default:[]},old_align:{type:"string",default:""},align:{type:"string",default:"full"}},edit:function(props){function toArray(s){var ret=[];0<s.length&&(ret=s.split(","));for(var i=0;i<ret.length;i++)""==ret[i]?ret.splice(i,1):ret[i]=Number(ret[i]);return ret}function getQuery(query){return"/wc/v2/products"+query}function getProducts(query){null===query&&(query=attributes.queryProducts,useEffect(function(){props.setAttributes({queryProductsLast:query})})),""!=query&&apiFetch({path:query}).then(function(products){props.setAttributes({result:products}),props.setAttributes({isLoading:!1}),!1===attributes.doneFirstLoad&&props.setAttributes({querySearchSelected:products}),props.setAttributes({doneFirstLoad:!0});for(var IDs="",i=0;i<products.length;i++)IDs+=products[i].id+",";props.setAttributes({productIDs:IDs}),props.setAttributes({selectedSlide:0})})}var attributes=props.attributes;return attributes.selectedSlide=attributes.selectedSlide||0,attributes.result=attributes.result||[],attributes.isLoading=attributes.isLoading||!1,attributes.querySearchString=attributes.querySearchString||"",attributes.querySearchResults=attributes.querySearchResults||[],attributes.querySearchNoResults=attributes.querySearchNoResults||!1,attributes.doneFirstLoad=attributes.doneFirstLoad||!1,"full"!=props.attributes.align&&props.setAttributes({align:"full"}),[el(InspectorControls,{key:"gbt-product-slider-inspector"},el("div",{key:"gbt-product-slider-inspector-wrapper",className:"products-main-inspector-wrapper"},el("div",{className:"products-ajax-search-wrapper"},el(TextControl,{key:"query-panel-string",type:"search",className:"products-ajax-search",value:attributes.querySearchString,placeholder:i18n.__("Search for products to display"),onChange:function(newQuery){if(props.setAttributes({querySearchString:newQuery}),!(newQuery.length<3)){var query=getQuery("?per_page=10&search="+newQuery);apiFetch({path:query}).then(function(products){0==products.length?props.setAttributes({querySearchNoResults:!0}):props.setAttributes({querySearchNoResults:!1}),props.setAttributes({querySearchResults:products})})}}})),0<attributes.querySearchResults.length&&""!=attributes.querySearchString&&el("div",{className:"products-ajax-search-results"},function(){var productElements=[];if(!0===attributes.querySearchNoResults)return el("span",{key:"gbt-vertical-slider-search-results-no-results",className:"no-results"},i18n.__("No products matching."));for(var theID,products=attributes.querySearchResults,i=0;i<products.length;i++){var img="";img=products[i].images.length&&void 0!==products[i].images[0].src&&""!=products[i].images[0].src?el("span",{key:"gbt-vertical-slider-search-results-img-wrapper",className:"img-wrapper",dangerouslySetInnerHTML:{__html:'<span class="img" style="background-image: url(\''+products[i].images[0].src+"')\"></span>"}}):el("span",{key:"gbt-vertical-slider-search-results-img-wrapper",className:"img-wrapper",dangerouslySetInnerHTML:{__html:'<span class="img" style="background-image: url(\''+getbowtied_pbw.woo_placeholder_image+"')\"></span>"}}),productElements.push(el("span",{key:"gbt-vertical-slider-search-result-item-"+products[i].id,className:(theID=products[i].id,-1==toArray(attributes.selectedIDS).indexOf(theID)?"single-result":"single-result selected"),title:products[i].name,"data-index":i},img,el("label",{key:"gbt-vertical-slider-search-result-item-title-"+i,className:"title-wrapper"},el("input",{key:"gbt-vertical-slider-search-result-item-checkbox-"+i,type:"checkbox",value:i,onChange:function(evt){evt.target;var qSR=toArray(attributes.selectedIDS),index=qSR.indexOf(products[evt.target.value].id);-1==index?qSR.push(products[evt.target.value].id):qSR.splice(index,1),props.setAttributes({selectedIDS:qSR.join(",")});var query=getQuery("?include="+qSR.join(",")+"&orderby=include");""!==query&&(0<qSR.length?props.setAttributes({queryProducts:query}):props.setAttributes({queryProducts:""})),apiFetch({path:query}).then(function(products){props.setAttributes({querySearchSelected:products})})}}),products[i].name,el("span",{key:"gbt-vertical-slider-search-result-item-dashicon-yes-"+i,className:"dashicons dashicons-yes"}),el("span",{key:"gbt-vertical-slider-search-result-item-dashicon-no-alt-"+i,className:"dashicons dashicons-no-alt"}))))}return productElements}()),0<attributes.querySearchSelected.length&&el("div",{className:"products-selected-results-wrapper"},el("label",{},i18n.__("Selected Products:")),el("div",{className:"products-selected-results"},function(){for(var productElements=[],products=attributes.querySearchSelected,i=0;i<products.length;i++){var img="";img=products[i].images.length&&void 0!==products[i].images[0].src&&""!=products[i].images[0].src?el("span",{key:"gbt-vertical-slider-search-selected-img-wrapper",className:"img-wrapper",dangerouslySetInnerHTML:{__html:'<span class="img" style="background-image: url(\''+products[i].images[0].src+"')\"></span>"}}):el("span",{key:"gbt-vertical-slider-search-selected-img-wrapper",className:"img-wrapper",dangerouslySetInnerHTML:{__html:'<span class="img" style="background-image: url(\''+getbowtied_pbw.woo_placeholder_image+"')\"></span>"}}),productElements.push(el("span",{key:"gbt-vertical-slider-search-selected-item-"+products[i].id,className:"single-result",title:products[i].name},img,el("label",{key:"gbt-vertical-slider-search-selected-item-title-"+i,className:"title-wrapper"},el("input",{key:"gbt-vertical-slider-search-selected-item-checkbox-"+i,type:"checkbox",value:i,onChange:function(evt){evt.target;var qSS=toArray(attributes.selectedIDS);if(qSS.length<1&&0<attributes.querySearchSelected.length)for(var _i=0;_i<attributes.querySearchSelected.length;_i++)qSS.push(attributes.querySearchSelected[_i].id);var index=qSS.indexOf(products[evt.target.value].id);-1!=index&&qSS.splice(index,1),props.setAttributes({selectedIDS:qSS.join(",")});var query=getQuery("?include="+qSS.join(",")+"&orderby=include");0<qSS.length?(props.setAttributes({queryProducts:query}),apiFetch({path:query}).then(function(products){props.setAttributes({querySearchSelected:products})})):(props.setAttributes({queryProducts:""}),props.setAttributes({querySearchSelected:[]}))}}),products[i].name,el("span",{key:"gbt-vertical-slider-search-selected-item-dashicon-no-alt-"+i,className:"dashicons dashicons-no-alt"}))))}return productElements}())),el("button",{className:"render-results components-button is-button is-default is-primary is-large "+(!0===attributes.isLoading?"is-busy":""),disabled:0==attributes.queryProducts.length||attributes.queryProducts===attributes.queryProductsLast,onClick:function(e){var query=attributes.queryProducts;props.setAttributes({isLoading:!0}),props.setAttributes({querySearchString:""}),props.setAttributes({querySearchResults:[]}),props.setAttributes({queryProductsLast:query}),getProducts(query)}},!1===attributes.isLoading?i18n.__("Update"):i18n.__("Updating")))),el("div",{key:"gbt_18_default_slider_main_wrapper"},el("div",{className:"gbt_18_editor_default_slider",key:"gbt_18_default_slider_products_wrapper"},attributes.result.length<1&&!1===attributes.doneFirstLoad&&getProducts(null),function(){for(var idx,products=attributes.result,wrapper=[],productElements=[],i=0;i<products.length;i++){var name=products[i].name;name=35<name.length?name.substring(0,35)+"...":name.substring(0,35),productElements.push(el("div",{className:"gbt_18_editor_slide_content_item slide "+(idx=i,attributes.selectedSlide==idx?"selected":""),key:"gbt_18_slide_content_item"+products[i].id},el("div",{className:"gbt_18_editor_slide_content_left",key:"gbt_18_editor_slide_content_left"+i},el("div",{className:"gbt_18_editor_slide_content_left_inner",key:"gbt_18_editor_slide_content_left_inner"+i},el("h2",{className:"gbt_18_editor_slide_title",key:"gbt_18_slide_title"+i},name),el("p",{className:"gbt_18_editor_slide_price",key:"gbt_18_slide_price"+i,dangerouslySetInnerHTML:{__html:products[i].price_html}}),el("button",{className:"gbt_18_editor_add_to_cart",key:"gbt_18_editor_add_to_cart"+i},i18n.__("Add To Cart")),el("div",{key:"gbt_18_editor_slide_link"+i,className:"gbt_18_editor_slide_link"},el("i",{key:"gbt_18_icon_right"+i,className:"gbt_18_icon_right"}),i18n.__("View Product Page")))),el("div",{className:"gbt_18_editor_slide_content_right",key:"gbt_18_editor_slide_content_right"+i},el("div",{className:"gbt_18_editor_image",key:"gbt_18_image"+i,style:{backgroundImage:"url("+products[i].images[0].src+")"}}))))}return 0==productElements.length&&productElements.push(el("div",{className:"gbt_18_editor_slide_placeholder_content_item",key:"gbt_18_slide_placeholder_content_item"},el("div",{className:"gbt_18_editor_slide_placeholder_content_left",key:"gbt_18_editor_slide_placeholder_content_left"},el("div",{className:"gbt_18_editor_slide_placeholder_title",key:"gbt_18_slide_placeholder_title"}),el("div",{className:"gbt_18_editor_slide_placeholder_p1",key:"gbt_18_editor_slide_placeholder_p1"}),el("div",{className:"gbt_18_editor_slide_placeholder_p2",key:"gbt_18_editor_slide_placeholder_p2"}),el("div",{className:"gbt_18_editor_slide_placeholder_p3",key:"gbt_18_editor_slide_placeholder_p3"}),el("div",{className:"gbt_18_editor_slide_placeholder_button",key:"gbt_18_editor_slide_placeholder_button"})),el("div",{className:"gbt_18_editor_slide_placeholder_content_right",key:"gbt_18_editor_slide_placeholder_content_right"},el("div",{className:"gbt_18_editor_placeholder_image",key:"gbt_18_editor_placeholder_image"})))),wrapper.push(el("div",{className:"gbt_18_editor_content",key:"gbt_18_content"},el("div",{className:"gbt_18_editor_content_wrapper",key:"gbt_18_content_wrapper"},el("div",{className:"gbt_18_editor_slide_content slider",key:"gbt_18_slide_content"},productElements),1<productElements.length&&el("div",{key:"gbt_18_slide_content_arrows",className:"gbt_18_slide_content_arrows"},el("button",{className:"toggle-prev toggle-arrow",onClick:function(){var idx=attributes.selectedSlide;0<=idx-1?props.setAttributes({selectedSlide:idx-1}):props.setAttributes({selectedSlide:productElements.length-1})}},el(SVG,{key:"gbt_18_slide_content_toggle-prev-button-svg",className:"toggle-prev-icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},el(Path,{key:"gbt_18_slide_content_toggle-prev-button-svg-path",d:"M512.088 87.404l289.008 289.095c9.996 9.999 26.205 10.001 36.204 0.005s10.001-26.205 0.005-36.204l-307.107-307.2c-9.996-9.999-26.205-10.001-36.204-0.005l-307.293 307.2c-9.999 9.996-10.001 26.205-0.005 36.204s26.205 10.001 36.204 0.005l289.188-289.101zM537.601 51.2c0-14.138-11.462-25.6-25.6-25.6s-25.6 11.462-25.6 25.6v819.2c0 14.138 11.462 25.6 25.6 25.6s25.6-11.462 25.6-25.6v-819.2z"}))),el("button",{className:"toggle-next toggle-arrow",onClick:function(){var idx=attributes.selectedSlide;idx+1<productElements.length?props.setAttributes({selectedSlide:idx+1}):props.setAttributes({selectedSlide:0})}},el(SVG,{key:"gbt_18_slide_content_toggle-next-button-svg",className:"toggle-next-icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},el(Path,{key:"gbt_18_slide_content_toggle-next-button-svg-path",d:"M222.905 545.101c-9.996-9.999-26.205-10.001-36.204-0.005s-10.001 26.205-0.005 36.204l307.107 307.2c9.996 9.999 26.205 10.001 36.204 0.005l307.293-307.2c9.999-9.996 10.001-26.205 0.005-36.204s-26.205-10.001-36.204-0.005l-289.188 289.101-289.008-289.095zM486.4 870.4c0 14.138 11.462 25.6 25.6 25.6s25.6-11.462 25.6-25.6v-819.2c0-14.138-11.462-25.6-25.6-25.6s-25.6 11.462-25.6 25.6v819.2z"}))))))),wrapper}()))]},save:function(){return null}})}(window.wp.blocks,window.wp.components,window.wp.editor,window.wp.i18n,window.wp.element,jQuery);