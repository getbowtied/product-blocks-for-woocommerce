"use strict";!function(e,t,r,u,s){var d=s.createElement,o=e.registerBlockType,_=t.TextControl,a=(t.SelectControl,t.RangeControl,t.SVG),l=t.Path,n=wp.blockEditor,p=n.InspectorControls,h=n.PanelColorSettings,g=wp.apiFetch,y=wp.element.useEffect;o("getbowtied/lookbook-reveal-product",{title:u.__("Lookbook Product"),icon:d(a,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},d(l,{d:"M21 4H3c-1.1 0-2 .9-2 2v13c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zM3 19V6h8v13H3zm18 0h-8V6h8v13zm-7-9.5h6V11h-6zm0 2.5h6v1.5h-6zm0 2.5h6V16h-6z"})),category:"product_blocks",parent:["getbowtied/lookbook-reveal"],attributes:{productIDs:{type:"string",default:""},queryProducts:{type:"string",default:""},queryProductsLast:{type:"string",default:""},queryDisplayType:{type:"string",default:"default"},isLoading:{type:"boolean",default:!1},selectedIDS:{type:"string",default:""},querySearchString:{type:"string",default:""},querySearchResults:{type:"array",default:[]},querySearchNoResults:{type:"boolean",default:!1},querySearchSelected:{type:"array",default:[]},bgColor:{type:"string",default:"#abb7c3"},textColor:{type:"string",default:"#ffffff"}},edit:function(l){function n(e){var t=[];0<e.length&&(t=e.split(","));for(var r=0;r<t.length;r++)""==t[r]?t.splice(r,1):t[r]=Number(t[r]);return t}function a(){return 0<i.querySearchSelected.length||0<n(i.selectedIDS).length?"is-disabled":""}function c(e){return"/wc/v2/products"+e}function r(e){null===e&&(e=i.queryProducts,y(function(){l.setAttributes({queryProductsLast:e})})),""!=e&&g({path:e}).then(function(e){l.setAttributes({result:e}),l.setAttributes({isLoading:!1}),!1===i.doneFirstLoad&&l.setAttributes({querySearchSelected:e}),l.setAttributes({doneFirstLoad:!0});for(var t="",r=0;r<e.length;r++)t+=e[r].id+",";l.setAttributes({productIDs:t}),l.setAttributes({selectedSlide:0})})}var i=l.attributes;i.result=i.result||[],i.doneFirstLoad=i.doneFirstLoad||!1;return[d(p,{key:"lookbook-reveal-inspector"},d("div",{className:"products-main-inspector-wrapper"},d("div",{className:"products-ajax-search-wrapper "+a()},d(_,{key:"query-panel-string",type:"search",className:"products-ajax-search",value:i.querySearchString,placeholder:u.__("Search for products to display"),disabled:0<i.querySearchSelected.length,onChange:function(e){if(l.setAttributes({querySearchString:e}),!(e.length<3)){var t=c("?per_page=10&search="+e);g({path:t}).then(function(e){0==e.length?l.setAttributes({querySearchNoResults:!0}):l.setAttributes({querySearchNoResults:!1}),l.setAttributes({querySearchResults:e})})}}})),0<i.querySearchResults.length&&""!=i.querySearchString&&d("div",{className:"products-ajax-search-results"},function(){var e=[];if(!0===i.querySearchNoResults)return d("span",{className:"no-results"},u.__("No products matching."));for(var t,o=i.querySearchResults,r=0;r<o.length;r++){var s="";void 0!==o[r].images[0].src&&""!=o[r].images[0].src&&(s=d("span",{className:"img-wrapper",dangerouslySetInnerHTML:{__html:'<span class="img" style="background-image: url(\''+o[r].images[0].src+"')\"></span>"}})),e.push(d("span",{key:"item-"+o[r].id+r,className:(t=o[r].id,(-1==n(i.selectedIDS).indexOf(t)?"single-result":"single-result selected")+" "+a()),title:o[r].name,"data-index":r},s,d("label",{className:"title-wrapper"},d("input",{type:"checkbox",value:r,onChange:function(e){if(!(0<n(i.selectedIDS).length)){e.target;var t=n(i.selectedIDS),r=t.indexOf(o[e.target.value].id);-1==r?t.push(o[e.target.value].id):t.splice(r,1),l.setAttributes({selectedIDS:t.join(",")});var s=c("?include="+t.join(",")+"&orderby=include");0<t.length?l.setAttributes({queryProducts:s}):l.setAttributes({queryProducts:""}),g({path:s}).then(function(e){l.setAttributes({querySearchSelected:e})})}}}),o[r].name,d("span",{className:"dashicons dashicons-yes"}),d("span",{className:"dashicons dashicons-no-alt"}))))}return e}()),0<i.querySearchSelected.length&&d("div",{className:"products-selected-results-wrapper"},d("label",{},u.__("Selected Products:")),d("div",{className:"products-selected-results"},function(){for(var e=[],a=i.querySearchSelected,t=0;t<a.length;t++){var r="";void 0!==a[t].images[0].src&&""!=a[t].images[0].src&&(r=d("span",{className:"img-wrapper",dangerouslySetInnerHTML:{__html:'<span class="img" style="background-image: url(\''+a[t].images[0].src+"')\"></span>"}})),e.push(d("span",{key:"item-"+a[t].id,className:"single-result",title:a[t].name},r,d("label",{className:"title-wrapper"},d("input",{type:"checkbox",value:t,onChange:function(e){var t=n(i.selectedIDS);if(t.length<1&&0<i.querySearchSelected.length)for(var r=0;r<i.querySearchSelected.length;r++)t.push(i.querySearchSelected[r].id);var s=t.indexOf(a[e.target.value].id);-1!=s&&t.splice(s,1),l.setAttributes({selectedIDS:t.join(",")});var o=c("?include="+t.join(",")+"&orderby=include");0<t.length?(l.setAttributes({queryProducts:o}),g({path:o}).then(function(e){l.setAttributes({querySearchSelected:e})})):(l.setAttributes({queryProducts:""}),l.setAttributes({querySearchSelected:[]}))}}),a[t].name,d("span",{className:"dashicons dashicons-no-alt"}))))}return e}())),d("button",{className:"render-results components-button is-button is-default is-primary is-large "+(!0===i.isLoading?"is-busy":""),disabled:0==i.queryProducts.length||i.queryProducts===i.queryProductsLast,onClick:function(e){var t=i.queryProducts;l.setAttributes({isLoading:!0}),l.setAttributes({querySearchString:""}),l.setAttributes({querySearchResults:[]}),l.setAttributes({queryProductsLast:t}),r(t)}},!1===i.isLoading?u.__("Update"):u.__("Updating")),d(h,{key:"lookbook-reveal-colors",title:u.__("Colors"),colors:[{name:"red",color:"#d02e2e"},{name:"orange",color:"#f76803"},{name:"yellow",color:"#fbba00"},{name:"green",color:"#43d182"},{name:"blue",color:"#2594e3"},{name:"white",color:"#ffffff"},{name:"dark-gray",color:"#abb7c3"},{name:"black",color:"#000"}],colorSettings:[{label:u.__("Background Color"),value:i.bgColor,onChange:function(e){l.setAttributes({bgColor:e})}},{label:u.__("Text Color"),value:i.textColor,onChange:function(e){l.setAttributes({textColor:e})}}]}))),i.result.length<1&&!1===i.doneFirstLoad&&r(null),function(){var e=i.result,t=[],r=[];if(0<e.length){for(var s="",o="gbt_18_editor_lookbook_product",a=0;a<e.length;a++)s=35<e[a].name.length?"...":"",t.push(d("div",{key:o+"_contentitem-"+e[a].id,className:o+"_content"},d("div",{key:o+"_content_left",className:o+"_content_left"},d("div",{key:o+"_content_left_inner_top",className:o+"_content_left_inner_top"},d("h2",{key:o+"_title",style:{color:i.textColor},className:o+"_title"},e[a].name.substring(0,35)+s),d("div",{key:o+"_text",style:{color:i.textColor},className:o+"_text",dangerouslySetInnerHTML:{__html:e[a].short_description}})),d("div",{key:o+"_content_left_inner_bottom",className:o+"_content_left_inner_bottom"},d("p",{key:o+"_price",style:{color:i.textColor},className:o+"_price",dangerouslySetInnerHTML:{__html:e[a].price_html}}),d("button",{key:o+"_button",style:{color:i.textColor,borderBottomColor:i.textColor},className:o+"_button"},"Add To Cart"))),d("div",{key:o+"_content_right",className:o+"_content_right"},d("div",{key:o+"_image",style:{backgroundImage:"url("+e[a].images[0].src+")"},className:o+"_image"}))));r.push(d("div",{className:"gbt_18_lookbook_reveal_product_wrapper",key:"gbt_18_lookbook_reveal_product_wrapper",style:{backgroundColor:i.bgColor}},t))}else{var l="gbt_18_editor_placeholder_lookbook_product";r.push(d("div",{key:l+"_wrapper",className:"gbt_18_editor_lookbook_product_wrapper placeholder"},d("div",{key:l+"_content",className:"gbt_18_editor_lookbook_product_content placeholder"},d("div",{key:l+"_content_left",className:l+"_content_left"},d("div",{key:l+"_content_left_inner_top",className:l+"_content_left_inner_top"},d("div",{className:l+"_title",key:l+"_title"}),d("div",{className:l+"_text1",key:l+"_text1"}),d("div",{className:l+"_text2",key:l+"_text2"})),d("div",{key:l+"_content_left_inner_bottom",className:l+"_content_left_inner_bottom"},d("div",{className:l+"_price",key:l+"_price"}),d("button",{className:l+"_button",key:l+"_button"},"Add To Cart"))),d("div",{key:l+"_content_right",className:l+"_content_right"},d("div",{className:l+"_image",key:l+"_image"})))))}return r}()]},save:function(e){return""}})}(window.wp.blocks,window.wp.components,window.wp.editor,window.wp.i18n,window.wp.element,jQuery);